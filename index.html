<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>五子棋</title>

<style>
body {
  margin: 0;
  background: #f0f0f0;
  font-family: "微軟正黑體", Arial, sans-serif;
}

.container {
  display: flex;
  padding: 20px;
}

/* 左側棋盤區 */
.board-area {
  flex: 3;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* 棋盤外框（多一圈） */
.board-wrapper {
  padding: 30px;
  background: #ddb87d;
}

/* 棋盤 */
.board {
  position: relative;
  width: 420px;
  height: 420px;
}

/* 棋盤格線 */
.line.horizontal,
.line.vertical {
  position: absolute;
  background: #333;
}

/* 14 條橫線 */
.line.horizontal {
  height: 1px;
  width: 420px;
}

/* 14 條直線 */
.line.vertical {
  width: 1px;
  height: 420px;
}

/* 交點 */
.point {
  position: absolute;
  width: 16px;
  height: 16px;
  transform: translate(-50%, -50%);
  cursor: pointer;
}
.stone {
  width: 24px;
  height: 24px;
  border-radius: 50%;
  position: absolute;
  transform: translate(-50%, -50%);
}

.stone.black {
  background: black;
}

.stone.white {
  background: white;
  border: 1px solid #000;
}

/* hover 預覽 */
.point::after {
  width: 24px;
  height: 24px;
}


/* 星位 */
.star {
  position: absolute;
  width: 6px;
  height: 6px;
  background: #000;
  border-radius: 50%;
  transform: translate(-50%, -50%);
}

/* 右側資訊欄 */
.info-area {
  flex: 1;
  margin-left: 20px;
  background: white;
  padding: 20px;
}

button {
  padding: 10px;
  font-size: 16px;
}
</style>
</head>

<body>

<div class="container">

  <div class="board-area">
    <div class="board-wrapper">
      <div class="board" id="board"></div>
    </div>
  </div>

  <div class="info-area">
    <h2>遊戲資訊</h2>
    <p>目前輪到：<strong>黑棋</strong></p>
    <button>悔棋</button><br><br>
    <button>重新開始</button>
  </div>

</div>
<script>
const board = document.getElementById("board");
const size = 15;
const gap = 30;

let currentPlayer = "black"; // black or white
let isPlayerTurn = true;
let gameOver = false; // ★ 用來避免勝負後繼續下棋
let chess = Array.from({ length: size }, () => Array(size).fill(null));

/* 選擇先後手 */
if (!confirm("你要先手（黑棋）嗎？\n按取消則你後手（白棋）")) {
  currentPlayer = "white";
  isPlayerTurn = false;
  setTimeout(computerMove, 500);
}

/* 畫棋盤線 */
for (let i = 0; i < size ; i++) {
  const h = document.createElement("div");
  h.className = "line horizontal";
  h.style.top = `${i * gap}px`;
  board.appendChild(h);

  const v = document.createElement("div");
  v.className = "line vertical";
  v.style.left = `${i * gap}px`;
  board.appendChild(v);
}

/* 建立交點 */
for (let y = 0; y < size; y++) {
  for (let x = 0; x < size; x++) {
    const point = document.createElement("div");
    point.className = "point";
    point.style.left = `${x * gap}px`;
    point.style.top = `${y * gap}px`;

    point.addEventListener("click", () => {
      if (!isPlayerTurn || gameOver) return;
      if (chess[y][x]) return;

      placeStone(x, y, currentPlayer);
      chess[y][x] = currentPlayer;

      if (checkWin(x, y, currentPlayer)) {
        gameOver = true;
        alert((currentPlayer === "black" ? "黑棋" : "白棋") + "勝利！");
        return;
      }

      switchTurn();
      setTimeout(computerMove, 300);
    });

    board.appendChild(point);
  }
}

/* 星位 */
[
  [3,3],[3,11],[7,7],[11,3],[11,11]
].forEach(([x,y]) => {
  const s = document.createElement("div");
  s.className = "star";
  s.style.left = `${x * gap}px`;
  s.style.top = `${y * gap}px`;
  board.appendChild(s);
});

/* 放棋子 */
function placeStone(x, y, color) {
  const stone = document.createElement("div");
  stone.className = `stone ${color}`;
  stone.style.left = `${x * gap}px`;
  stone.style.top = `${y * gap}px`;
  board.appendChild(stone);
}

/* 換手 */
function switchTurn() {
  currentPlayer = currentPlayer === "black" ? "white" : "black";
  isPlayerTurn = !isPlayerTurn;
}

/* 勝負判斷 */
function checkWin(x, y, color) {
  // 定義四個方向向量
  const directions = [
    [1, 0],  // 橫向 →
    [0, 1],  // 直向 ↓
    [1, 1],  // 斜向 ↘
    [1, -1]  // 反斜 ↗
  ];

  for (let [dx, dy] of directions) {
    let count = 1;

    // 往前算
    let nx = x + dx, ny = y + dy;
    while (nx >= 0 && ny >= 0 && nx < size && ny < size && chess[ny][nx] === color) {
      count++;
      nx += dx;
      ny += dy;
    }

    // 往後算
    nx = x - dx; ny = y - dy;
    while (nx >= 0 && ny >= 0 && nx < size && ny < size && chess[ny][nx] === color) {
      count++;
      nx -= dx;
      ny -= dy;
    }

    if (count >= 5) return true;
  }

  return false;
}

/* 電腦下棋（簡單隨機） */
function computerMove() {
  if (isPlayerTurn || gameOver) return;

  let empty = [];
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (!chess[y][x]) empty.push([x, y]);
    }
  }

  if (empty.length === 0) return;

  const [x, y] = empty[Math.floor(Math.random() * empty.length)];

  placeStone(x, y, currentPlayer);
  chess[y][x] = currentPlayer;

  if (checkWin(x, y, currentPlayer)) {
    gameOver = true;
    alert((currentPlayer === "black" ? "黑棋" : "白棋") + "勝利！");
    return;
  }

  switchTurn();
}
</script>



</body>
</html>
